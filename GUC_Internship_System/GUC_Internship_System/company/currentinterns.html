<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <link rel="stylesheet" href="../css/company_base.css" />

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Fixed Header -->
    <header class="fixed-header">
      <h1>Current Interns</h1>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>Company Portal</h2>
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li>
            <a href="company_dashboard.html" class="nav-link">
              <i class="fas fa-home"></i> Dashboard
            </a>
          </li>
          <li>
            <a href="register.html" class="nav-link">
              <i class="fas fa-user"></i> Register
            </a>
          </li>
          <li>
            <a href="upload-documents.html" class="nav-link">
              <i class="fas fa-upload"></i> Upload Documents
            </a>
          </li>
          <li>
            <a href="job-posts.html" class="nav-link">
              <i class="fas fa-briefcase"></i> Job Posts
            </a>
          </li>
          <li>
            <a href="evaluate.html" class="nav-link">
              <i class="fas fa-star"></i> Evaluate Intern
            </a>
          </li>
          <li>
            <a href="applications.html" class="nav-link">
              <i class="fas fa-paper-plane"></i> Applications
            </a>
          </li>
          <li>
            <a href="currentinterns.html" class="nav-link active">
              <i class="fas fa-graduation-cap"></i> Current Interns
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <div class="dashboard-container">
      <div id="currentInternsSection">
        <h3>Interns List</h3>
        <!-- Dropdown to filter interns by status -->
        <select id="filterInternStatus" onchange="filterInternsByStatus()">
          <option value="">All Interns</option>
          <option value="current intern">Current Interns</option>
          <option value="internship complete">Internship Complete</option>
        </select>
        <input
          type="text"
          id="searchInternInput"
          placeholder="Search by name or job title..."
          oninput="searchInterns()"
        />
        <ul id="currentInternsList"></ul>
      </div>

      <!-- Intern Details Section -->
      <div
        id="internDetails"
        style="
          display: none;
          border: 1px solid #ccc;
          padding: 10px;
          margin-top: 20px;
        "
      >
        <h4>Intern Details</h4>
        <p id="internName"></p>
        <p id="internEmail"></p>
        <p id="internResume"></p>
        <p id="internStatus"></p>
      </div>
    </div>

    <script src="js/currentinterns.js"></script>
    <script>
      // Example data for interns
      const jobPosts = JSON.parse(localStorage.getItem("jobPosts")) || [];
      console.log("Job Posts Data:", jobPosts);

      // Display interns with "Evaluate Intern" button for "internship complete" status
      function displayInterns() {
        console.log("displayInterns function called");
        const currentInternsList =
          document.getElementById("currentInternsList");
        currentInternsList.innerHTML = ""; // Clear the list

        jobPosts.forEach((post) => {
          post.applications.forEach((application) => {
            const li = document.createElement("li");
            li.textContent = `Name: ${application.name}, Job Title: ${post.title}, Status: ${application.status}`;

            // Add "Evaluate Intern" button for completed internships
            if (application.status === "internship complete") {
              const evaluateButton = document.createElement("button");
              evaluateButton.textContent = "Evaluate Intern";
              evaluateButton.style.marginLeft = "10px";
              evaluateButton.onclick = () => redirectToEvaluate(application);
              li.appendChild(evaluateButton);
            }

            currentInternsList.appendChild(li);
          });
        });
      }

      // Redirect to the Evaluate Intern page
      function redirectToEvaluate(intern) {
        // Pass intern details to the evaluate page (if needed)
        localStorage.setItem("selectedIntern", JSON.stringify(intern));
        window.location.href = "evaluate.html";
      }

      // Call displayInterns on page load
      document.addEventListener("DOMContentLoaded", displayInterns);
    </script>
  </body>
</html>
